<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Privacy Guard</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <!-- Header -->
  <header class="pg-header">
    <div class="pg-logo">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
        <path d="M12 2L4 6V11C4 16.55 7.84 21.74 13 23C18.16 21.74 22 16.55 22 11V6L12 2Z" 
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M9 12L11 14L15 10" 
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <h1>Privacy Guard</h1>
    </div>
    <button class="pg-settings-btn" id="settingsBtn" title="Settings">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
        <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
        <path d="M12 1V3M12 21V23M4.22 4.22L5.64 5.64M18.36 18.36L19.78 19.78M1 12H3M21 12H23M4.22 19.78L5.64 18.36M18.36 5.64L19.78 4.22" 
              stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
      </svg>
    </button>
  </header>

  <!-- Main Content -->
  <main class="pg-main" id="mainContent">
    
    <!-- Loading State -->
    <div class="pg-loading" id="loadingState">
      <div class="pg-spinner"></div>
      <p>Analyse en cours...</p>
    </div>

    <!-- No Analysis State -->
    <div class="pg-no-analysis" id="noAnalysisState" style="display: none;">
      <div class="pg-empty-icon">üîç</div>
      <h2>Aucune analyse disponible</h2>
      <p>Visitez une page avec une politique de confidentialit√© ou des conditions d'utilisation pour d√©marrer l'analyse.</p>
      <button class="pg-btn pg-btn-primary" id="analyzeCurrentBtn">
        Analyser cette page
      </button>
    </div>

    <!-- Analysis Results -->
    <div class="pg-results" id="resultsState" style="display: none;">
      
      <!-- Score Card -->
      <div class="pg-score-card">
        <div class="pg-score-circle" id="scoreCircle">
          <svg width="120" height="120" viewBox="0 0 120 120">
            <circle cx="60" cy="60" r="54" fill="none" stroke="#e5e7eb" stroke-width="8"/>
            <circle id="scoreProgress" cx="60" cy="60" r="54" fill="none" 
                    stroke-width="8" stroke-linecap="round"
                    stroke-dasharray="339.292" stroke-dashoffset="339.292"
                    transform="rotate(-90 60 60)"/>
          </svg>
          <div class="pg-score-value">
            <span id="scoreValue">--</span>
            <span class="pg-score-label">/ 100</span>
          </div>
        </div>
        
        <div class="pg-score-info">
          <div class="pg-risk-badge" id="riskBadge">
            <span class="pg-risk-icon" id="riskIcon">!</span>
            <span class="pg-risk-label" id="riskLabel">En cours...</span>
          </div>
          <p class="pg-risk-description" id="riskDescription">
            Analyse de la transparence en cours...
          </p>
        </div>
      </div>

      <!-- Key Points -->
      <section class="pg-section">
        <h3 class="pg-section-title">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M9 11L12 14L22 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M21 12V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19V5C3 3.89543 3.89543 3 5 3H16" 
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Points Cl√©s
        </h3>
        <ul class="pg-key-points" id="keyPoints">
          <!-- Dynamically populated -->
        </ul>
      </section>

      <!-- Detected Clauses -->
      <section class="pg-section">
        <h3 class="pg-section-title">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M10.29 3.86L1.82 18A2 2 0 003.64 21H20.36A2 2 0 0022.18 18L13.71 3.86A2 2 0 0010.29 3.86Z" 
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <line x1="12" y1="9" x2="12" y2="13" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <line x1="12" y1="17" x2="12.01" y2="17" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          Clauses D√©tect√©es
          <span class="pg-badge" id="clauseCount">0</span>
        </h3>
        <div class="pg-clauses" id="detectedClauses">
          <!-- Dynamically populated -->
        </div>
      </section>

      <!-- Recommendations -->
      <section class="pg-section">
        <h3 class="pg-section-title">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
            <path d="M12 16V12M12 8H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          Recommandations
        </h3>
        <ul class="pg-recommendations" id="recommendations">
          <!-- Dynamically populated -->
        </ul>
      </section>

      <!-- Actions -->
      <div class="pg-actions">
        <button class="pg-btn pg-btn-outline" id="viewDetailedBtn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
            <path d="M14 2H6C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V8L14 2Z" 
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Analyse D√©taill√©e
        </button>
        <button class="pg-btn pg-btn-primary" id="compareMarketBtn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
            <path d="M18 20V10M12 20V4M6 20V14" 
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Comparer
        </button>
      </div>
    </div>

    <!-- Error State -->
    <div class="pg-error" id="errorState" style="display: none;">
      <div class="pg-error-icon">‚ö†Ô∏è</div>
      <h2>Erreur d'analyse</h2>
      <p id="errorMessage">Une erreur s'est produite lors de l'analyse.</p>
      <button class="pg-btn pg-btn-primary" id="retryBtn">R√©essayer</button>
    </div>

  </main>

  <!-- Footer -->
  <footer class="pg-footer">
    <div class="pg-footer-info">
      <span class="pg-footer-text">Derni√®re analyse : <span id="lastAnalyzed">--</span></span>
    </div>
    <button class="pg-footer-link" id="aboutBtn">√Ä propos</button>
  </footer>

  <script type="module" src="popup.js"></script>
</body>
</html>
